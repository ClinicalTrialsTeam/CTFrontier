WARNING: executing `cdk` commands directly is not recommended
Resources:
  CtfMonitoringtopic54525C29:
    Type: AWS::SNS::Topic
    Properties:
      TopicName: ctfrontier-notifications
    Metadata:
      aws:cdk:path: ctfrontier/CtfMonitoring/topic/Resource
  CtfMonitoringtopicnataliemonagharvardedu5B1CD7C0:
    Type: AWS::SNS::Subscription
    Properties:
      Protocol: email
      TopicArn:
        Ref: CtfMonitoringtopic54525C29
      Endpoint: nataliemona@g.harvard.edu
    Metadata:
      aws:cdk:path: ctfrontier/CtfMonitoring/topic/nataliemona@g.harvard.edu/Resource
  RawDataFilesBucketbucketA41A003C:
    Type: AWS::S3::Bucket
    Properties:
      BucketName: ctfrontier-raw-data-files
      LifecycleConfiguration:
        Rules:
          - AbortIncompleteMultipartUpload:
              DaysAfterInitiation: 1
            ExpirationInDays: 1
            Id: DeleteAfterOneWeek
            Status: Enabled
    UpdateReplacePolicy: Delete
    DeletionPolicy: Delete
    Metadata:
      aws:cdk:path: ctfrontier/RawDataFilesBucket/bucket/Resource
  RawDataDownloadFunctionfunctionServiceRole03BF456C:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service: lambda.amazonaws.com
        Version: "2012-10-17"
      ManagedPolicyArns:
        - Fn::Join:
            - ""
            - - "arn:"
              - Ref: AWS::Partition
              - :iam::aws:policy/service-role/AWSLambdaBasicExecutionRole
    Metadata:
      aws:cdk:path: ctfrontier/RawDataDownloadFunction/function/ServiceRole/Resource
  RawDataDownloadFunctionfunctionFC021CA9:
    Type: AWS::Lambda::Function
    Properties:
      Code:
        ImageUri:
          Fn::Join:
            - ""
            - - 591882417372.dkr.ecr.us-east-1.
              - Ref: AWS::URLSuffix
              - /ctf-lambda-repository:latest
      Role:
        Fn::GetAtt:
          - RawDataDownloadFunctionfunctionServiceRole03BF456C
          - Arn
      Environment:
        Variables:
          TEST_ENV: test_val
      FunctionName: ctfrontier-raw-data-download
      MemorySize: 128
      PackageType: Image
      Timeout: 30
    DependsOn:
      - RawDataDownloadFunctionfunctionServiceRole03BF456C
    Metadata:
      aws:cdk:path: ctfrontier/RawDataDownloadFunction/function/Resource
  RawDataDownloadFunctionfunctionLogRetentionAEFD9125:
    Type: Custom::LogRetention
    Properties:
      ServiceToken:
        Fn::GetAtt:
          - LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aFD4BFC8A
          - Arn
      LogGroupName:
        Fn::Join:
          - ""
          - - /aws/lambda/
            - Ref: RawDataDownloadFunctionfunctionFC021CA9
      RetentionInDays: 7
    Metadata:
      aws:cdk:path: ctfrontier/RawDataDownloadFunction/function/LogRetention/Resource
  RawDataDownloadFunctionfunctionEventInvokeConfig2B6752F8:
    Type: AWS::Lambda::EventInvokeConfig
    Properties:
      FunctionName:
        Ref: RawDataDownloadFunctionfunctionFC021CA9
      Qualifier: $LATEST
      MaximumRetryAttempts: 0
    Metadata:
      aws:cdk:path: ctfrontier/RawDataDownloadFunction/function/EventInvokeConfig/Resource
  RawDataDownloadFunctionfunctionVersionLATEST4BBADBDC:
    Type: AWS::Lambda::Version
    Properties:
      FunctionName:
        Ref: RawDataDownloadFunctionfunctionFC021CA9
    Metadata:
      aws:cdk:path: ctfrontier/RawDataDownloadFunction/function/Version$LATEST/Resource
  RawDataDownloadFunctionaliasD188AD81:
    Type: AWS::Lambda::Alias
    Properties:
      FunctionName:
        Ref: RawDataDownloadFunctionfunctionFC021CA9
      FunctionVersion:
        Fn::GetAtt:
          - RawDataDownloadFunctionfunctionVersionLATEST4BBADBDC
          - Version
      Name: live
      Description: initial release
    Metadata:
      aws:cdk:path: ctfrontier/RawDataDownloadFunction/alias/Resource
  RawDataDownloadFunctionErrorsAlarmDF61183C:
    Type: AWS::CloudWatch::Alarm
    Properties:
      ComparisonOperator: GreaterThanOrEqualToThreshold
      EvaluationPeriods: 1
      AlarmActions:
        - Ref: CtfMonitoringtopic54525C29
      AlarmName:
        Fn::Join:
          - ""
          - - Ref: RawDataDownloadFunctionfunctionFC021CA9
            - -errors
      Dimensions:
        - Name: FunctionName
          Value:
            Ref: RawDataDownloadFunctionfunctionFC021CA9
      MetricName: Errors
      Namespace: AWS/Lambda
      Period: 60
      Statistic: Sum
      Threshold: 1
    Metadata:
      aws:cdk:path: ctfrontier/RawDataDownloadFunction/ErrorsAlarm/Resource
  LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service: lambda.amazonaws.com
        Version: "2012-10-17"
      ManagedPolicyArns:
        - Fn::Join:
            - ""
            - - "arn:"
              - Ref: AWS::Partition
              - :iam::aws:policy/service-role/AWSLambdaBasicExecutionRole
    Metadata:
      aws:cdk:path: ctfrontier/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole/Resource
  LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRoleDefaultPolicyADDA7DEB:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - logs:PutRetentionPolicy
              - logs:DeleteRetentionPolicy
            Effect: Allow
            Resource: "*"
        Version: "2012-10-17"
      PolicyName: LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRoleDefaultPolicyADDA7DEB
      Roles:
        - Ref: LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB
    Metadata:
      aws:cdk:path: ctfrontier/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole/DefaultPolicy/Resource
  LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aFD4BFC8A:
    Type: AWS::Lambda::Function
    Properties:
      Handler: index.handler
      Runtime: nodejs12.x
      Code:
        S3Bucket:
          Ref: AssetParameters67b7823b74bc135986aa72f889d6a8da058d0c4a20cbc2dfc6f78995fdd2fc24S3Bucket4D46ABB5
        S3Key:
          Fn::Join:
            - ""
            - - Fn::Select:
                  - 0
                  - Fn::Split:
                      - "||"
                      - Ref: AssetParameters67b7823b74bc135986aa72f889d6a8da058d0c4a20cbc2dfc6f78995fdd2fc24S3VersionKeyB0F28861
              - Fn::Select:
                  - 1
                  - Fn::Split:
                      - "||"
                      - Ref: AssetParameters67b7823b74bc135986aa72f889d6a8da058d0c4a20cbc2dfc6f78995fdd2fc24S3VersionKeyB0F28861
      Role:
        Fn::GetAtt:
          - LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB
          - Arn
    DependsOn:
      - LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRoleDefaultPolicyADDA7DEB
      - LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB
    Metadata:
      aws:cdk:path: ctfrontier/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/Resource
  CDKMetadata:
    Type: AWS::CDK::Metadata
    Properties:
      Analytics: v2:deflate64:H4sIAAAAAAAAE2WQQWsCMRCFf4v3OFak0N6q0kKhB1lL73Ec13SzGckkioT8926yVQo9zZeXyZu8mcPzI8wnL/oiU9x3s4TsCdI2aOzUmp0EHzGo9cE1JBw9krrDUoTC0Nka15aOjfa6p0A+q2KXxAmkTz4ZLLcjbONO0JtTMOyK+veclSwgrSJ2VCeOlBWhh4ZOLCawv660kLK63+01pLfo8GZ159czufDuztzRkOBg6uf+i1/k5ffpDZfWaClChayM7iE1bKkuoNQNW4PXmrZSVpZbgQ9umyG5q/PRctxfdMAjpKXVvh8dBygJp7qsTaBuL2e1uYYju9kCnuBh8i3GTH0cfHqCZqw/HwgLo6MBAAA=
    Metadata:
      aws:cdk:path: ctfrontier/CDKMetadata/Default
Parameters:
  AssetParameters67b7823b74bc135986aa72f889d6a8da058d0c4a20cbc2dfc6f78995fdd2fc24S3Bucket4D46ABB5:
    Type: String
    Description: S3 bucket for asset "67b7823b74bc135986aa72f889d6a8da058d0c4a20cbc2dfc6f78995fdd2fc24"
  AssetParameters67b7823b74bc135986aa72f889d6a8da058d0c4a20cbc2dfc6f78995fdd2fc24S3VersionKeyB0F28861:
    Type: String
    Description: S3 key for asset version "67b7823b74bc135986aa72f889d6a8da058d0c4a20cbc2dfc6f78995fdd2fc24"
  AssetParameters67b7823b74bc135986aa72f889d6a8da058d0c4a20cbc2dfc6f78995fdd2fc24ArtifactHashBA91B77F:
    Type: String
    Description: Artifact hash for asset "67b7823b74bc135986aa72f889d6a8da058d0c4a20cbc2dfc6f78995fdd2fc24"

